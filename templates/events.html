<!DOCTYPE html>
<head>
    <title>Events</title>
</head>
<body>
    <h1>Events</h1>
        <!-- Add New Event Button -->
        <button id="addEvent" onclick="document.getElementById('newEventForm').style.display='block'">Add New Event</button>

        <!-- New Event Form -->
        <div id="newEventForm" style="display:none">
            <h1>Create Event</h1>
            <form action="/events" method="post">
                <label for="event_name">Event Name:</label><br>
                <input type="text" id="event_name" name="event_name" required><br>
                <label for="event_date">Event Date:</label><br>
                <input type="date" id="event_date" name="event_date" required><br>
                <label for="venue_id">Venue ID:</label><br>
                <input type="number" id="venue_id" name="venue_id" required><br>
                <label for="organizer_id">Organizer ID:</label><br>
                <input type="number" id="organizer_id" name="organizer_id" required><br>

                <!-- <label for="venue_id">Venue:</label><br>
                <select id="venue_id" name="venue_id">
                    !-- Options will be filled in with JavaScript --
                </select><br>
                <label for="organizer_id">Organizer:</label><br>
                <select id="organizer_id" name="organizer_id">
                    !-- Options will be filled in with JavaScript --
                </select><br> -->
                <input type="submit" value="Submit">
            </form>
        </div>

        <script>
            window.onload = function() {
                if (window.performance.navigation.type === 2) {  // if the page was loaded via a redirect
                    alert("New event added successfully!");
                }
            };
        </script>
        
    <!-- List all events -->
    <table>
        <tr>
            <th>Event Name</th>
            <th>Event Date</th>
            <th>Venue</th>
            <th>Organizer</th>
            <th>Actions</th>
        </tr>
        {% for event in events %}
        <tr>
            <td>{{ event.event_name }}</td>
            <td>{{ event.event_date }}</td>
            <td>{{ event.venue_name }}</td>
            <td>{{ event.organizer_name }}</td>
            <td>
                <button onclick="updateEvent({{ event.event_id }})">Update</button>
                <button onclick="confirmDelete({{ event.event_id }})">Delete</button>
            </td>
        </tr>
        {% endfor %}
    </table>

    <script>
        function updateEvent(id) {
            window.location.href = `/events/update/${id}`;
        }
    </script>

    <script>
        function confirmDelete(id) {
            if (confirm("Are you sure you want to delete this event?")) {
                deleteEvent(id);
            }
        }

        function deleteEvent(id) {
            fetch(`/events/${id}`, {
                method: 'DELETE',
            })
            .then(response => response.json())
            .then(data => {
                alert('Delete successful');
                location.reload();
            })
            .catch((error) => {
                console.error('Error:', error);
            });
        }
    </script>

<!-- <script>
    // Your JavaScript code here

    // Fetch venues and organizers from the server
    fetch('/venuesjson')
        .then(response => response.json())
        .then(venues => {
            const venueSelect = document.getElementById('venue_id');
            venues.forEach(venue => {
                const option = document.createElement('option');
                option.value = venue.id;
                option.text = venue.name;
                venueSelect.appendChild(option);
            });
        })
    .catch((error) => {
        console.error('Error:', error);
    });

    fetch('/organizersjson')
        .then(response => response.json())
        .then(organizers => {
            const organizerSelect = document.getElementById('organizer_id');
            organizers.forEach(organizer => {
                const option = document.createElement('option');
                option.value = organizer.id;
                option.text = organizer.name;
                organizerSelect.appendChild(option);
            });
        });
</script> -->
</body>
</html>
